b.innerHTML="<center><p onclick=g(1,3,3,f=1)>xno<p onclick=g(3,3,3,f=1)>xno 3d<p onclick=g(1,6,7,f=2)>find 4<p onclick=g(1,8,8,f=0)>reversi<p id=B><p id=C><p id=D>",g=function(b,g,h){for(c=e=1,i=0,d=[],f||(d[27]=d[36]=-1,d[28]=d[35]=1),B.innerHTML="";b--;){for(a="<br><table border>",j=g;j--;)for(a+="<tr>",k=h;k--;)d[i]=d[i]||0,a+="<th width=20 onclick=m(this,"+i+","+(7-j)+","+(7-k)+") id=t"+i+">"+"x.o"[d[i++]+1];B.innerHTML+=a}C.innerHTML="O",D.innerHTML=""},m=function(b,g,h,m){if(e&&!d[g]){if(f)if(1==f){for(b.innerHTML="xno"[c+1],a=3*(d[g]=c),i=3;i--;)for(j=3;j--;)if(d[9*i+j]+d[9*i+j+3]+d[9*i+j+6]==a||d[9*i+3*j]+d[9*i+3*j+1]+d[9*i+3*j+2]==a||d[9*i+0]+d[9*i+4]+d[9*i+8]==a||d[9*i+2]+d[9*i+4]+d[9*i+6]==a||d[3*i]+d[9+3*i+1]+d[18+3*i+2]==a||d[3*i+2]+d[9+3*i+1]+d[18+3*i]==a||d[i]+d[9+i+3]+d[18+i+6]==a||d[i+6]+d[9+i+3]+d[18+i]==a||d[13]+d[0]+d[26]==a||d[13]+d[2]+d[24]==a||d[13]+d[8]+d[18]==a||d[13]+d[6]+d[20]==a||d[3*i+j]+d[9+3*i+j]+d[18+3*i+j]==a)return e&=C.innerHTML="xno"[c+1]+" won"}else{if(2!=f||!(g>34||d[g+7]))return;for(b.innerHTML="xno"[c+1],a=4*(d[g]=c),i=6;i--;)for(j=7;j--;)if(B=7*i+j,4>j&&d[B]+d[B+1]+d[B+2]+d[B+3]==a||3>i&&d[B]+d[B+7]+d[B+14]+d[B+21]==a||3>i&&4>j&&d[B]+d[B+8]+d[B+16]+d[B+24]==a||3>i&&j>2&&d[B]+d[B+6]+d[B+12]+d[B+18]==a)return e&=C.innerHTML="xno"[c+1]+" won"}else{for(q=0,v=2;~v--;)for(u=2;~u--;)if(u|v&&(p=0,d[8*(h+v)+m+u]==-c)){for(i=h+2*v,j=m+2*u;i>=0&&9>i&&j>=0&&9>j;i+=v,j+=u){if(d[8*i+j]==c){p=q=1;break}if(!d[8*i+j])break}if(p)for(k=h,l=m;k!=i||l!=j;k+=v,l+=u)this["t"+(8*k+l)].innerHTML="xno"[c+1],d[8*k+l]=c}u=0;for(i in d)u+=d[i];if(D.innerHTML=u?"xo"[0|u>0]+"+":"=",!q)return}c=-c,C.innerHTML="xno"[c+1],-1==d.indexOf(0)&&(e&=C.innerHTML="=")}}