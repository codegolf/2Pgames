b.innerHTML="<center><p><button onclick=g(f=1)>XnO<button onclick=g(f=2)>Find 4<button onclick=g(f=0)>Reversi</button><p id=B><p id=C>";g=function(w,h,x){c=e=1;i=0;d=[];a="<table border>";for(j="836"[f];j--;)for(a+="<tr>",k="837"[f];k--;a+="<th width=20 onclick=m(this,"+i+") id=t"+i+++">\240")d[i]=0;B.innerHTML=a;C.innerHTML="O next";f||(d[27]=d[36]=-1,d[28]=d[35]=1,t27.innerHTML=t36.innerHTML="X",t28.innerHTML=t35.innerHTML="O")};m=function(w,h,x){if(e&&!d[h])if(f){if(1==f){if(w.innerHTML="XnO"[c+1],a=3*(d[h]=c),d[0]+d[1]+d[2]==a||d[0]+d[3]+d[6]==a||d[0]+d[4]+d[8]==a||d[1]+d[4]+d[7]==a||d[2]+d[5]+d[8]==a||d[2]+d[4]+d[6]==a||d[3]+d[4]+d[5]==a||d[6]+d[7]+d[8]==a){e&=C.innerHTML="XnO"[c+1]+" won!";return}}else if(2==f&&34<h||d[h+7])for(w.innerHTML="XnO"[c+1],a=4*(d[h]=c),i=6;i--;)for(j=7;j--;){if(4>j&&d[7*i+j]+d[7*i+j+1]+d[7*i+j+2]+d[7*i+j+3]==a||3>i&&d[7*i+j]+d[7*i+j+7]+d[7*i+j+14]+d[7*i+j+21]==a||3>i&4>j&&d[7*i+j]+d[7*i+j+8]+d[7*i+j+16]+d[7*i+j+24]==a||3>i&&2<j&&d[7*i+j]+d[7*i+j+6]+d[7*i+j+12]+d[7*i+j+18]==a){e&=C.innerHTML="XnO"[c+1]+" won!";return}}else return;c=-c;C.innerHTML="XnO"[c+1]+" next";~d.indexOf(0)?0:e&=C.innerHTML="draw!"}else if(q=0,n=h>>3,o=h%8,t(n,o,1),q){c=-c;C.innerHTML="XnO"[c+1]+" next";for(n=q=0;8>n;n++)for(o=0;8>o;o++)d[8*n+o]||t(n,o);if(!q){c=-c;C.innerHTML="XnO"[c+1]+" next";for(n=q=0;8>n;n++)for(o=0;8>o;o++)d[8*n+o]||t(n,o);if(!q){u=0;for(i in d)u+=d[i];e&=C.innerHTML=u?"XO"[+(0<u)]+" won!":"draw!"}}}};t=function(w,h,x){s=[-1,0,1,1,1,0,-1,-1];for(v in r=[-1,-1,-1,0,1,1,1,0])if(p=0,d[8*(w+r[v])+h+s[v]]==-c){i=2*r[v]+w;for(j=h+2*s[v];0<=i&&9>i&&0<=j&&9>j;i+=r[v],j+=s[v]){if(d[8*i+j]==c){p=q=1;break}if(!d[8*i+j])break}if(p&&x)for(k=w,l=h;k!=i||l!=j;k+=r[v],l+=s[v])this["t"+(8*k+l)].innerHTML="XnO"[c+1],d[8*k+l]=c}}